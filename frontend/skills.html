<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Skills & Interests</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .profile-card {
      max-width: 700px;
      margin: 40px auto;
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    .progress {
      text-align: center;
      margin-bottom: 40px;
    }
    .step {
      display: inline-block;
      width: 40px;
      height: 40px;
      line-height: 40px;
      background: #e0e0e0;
      border-radius: 50%;
      margin: 0 15px;
      font-weight: bold;
    }
    .step.done {
      background: #4CAF50;
      color: white;
    }
    .step.active {
      background: #4CAF50;
      color: white;
    }
    .pill-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 20px 0;
    }
    .pill {
      padding: 12px 24px;
      border: 1px solid #ddd;
      border-radius: 30px;
      background: white;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 15px;
    }
    .pill.selected {
      background: #4CAF50;
      color: white;
      border-color: #4CAF50;
    }
    .btn-group {
      display: flex;
      justify-content: space-between;
      margin-top: 50px;
    }
    .btn {
      padding: 14px 30px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      cursor: pointer;
    }
    .back-btn {
      background: #f0f0f0;
      color: #333;
    }
    .complete-btn {
      background: #4CAF50;
      color: white;
    }
    .skip {
      text-align: center;
      margin-top: 30px;
      color: #666;
      cursor: pointer;
      /* Light mode (default) */
:root {
  --bg: #f8f9fa;
  --text: #333;
  --card-bg: white;
  --header-bg: white;
  --shadow: 0 4px 15px rgba(0,0,0,0.05);
  --primary: #10b981;
  --border: #ddd;
  --modal-bg: white;
}

/* Dark mode */
[data-theme="dark"] {
  --bg: #121212;
  --text: #e0e0e0;
  --card-bg: #1e1e1e;
  --header-bg: #1a1a1a;
  --shadow: 0 4px 15px rgba(0,0,0,0.4);
  --border: #333;
  --modal-bg: #1e1e1e;
}

/* Apply variables */
body {
  background: var(--bg);
  color: var(--text);
  transition: background 0.3s ease, color 0.3s ease;
}

.header {
  background: var(--header-bg);
  transition: background 0.3s ease;
}

.job-card, .profile-card, .stat-card, .modal-content {
  background: var(--card-bg);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  color: var(--text);
  transition: background 0.3s ease, color 0.3s ease;
}

input, button, select {
  background: var(--card-bg);
  color: var(--text);
  border: 1px solid var(--border);
}

.tag, .match-badge {
  opacity: 0.9;
}

.modal {
  background: rgba(0,0,0,0.8);
}
    }
  </style>
</head>
<body>
  <div class="theme-toggle" id="theme-toggle" onclick="toggleTheme()" style="cursor: pointer; font-size: 24px; margin-left: 20px;">
  üåô
  </div>
  <div class="profile-card">
    <div class="progress">
      <span class="step done">1</span>
      <span style="font-size:20px;">‚Äî</span>
      <span class="step active">2</span>
    </div>

    <h2 style="text-align: center; margin-bottom: 10px;">Skills & Interests</h2>
    <p style="text-align: center; color: #666; margin-bottom: 40px;">Personalize your experience</p>

    <label><strong>Your Skills</strong><br><small>Select skills you have or want to develop</small></label>
    <div class="pill-group" id="skills-group">
        
        <div class="pill" onclick="togglePill(this)">Python</div>
        <div class="pill" onclick="togglePill(this)">JavaScript</div>
        <div class="pill" onclick="togglePill(this)">React</div>
        <div class="pill" onclick="togglePill(this)">Node.js</div>
        <div class="pill" onclick="togglePill(this)">TypeScript</div>
        <div class="pill" onclick="togglePill(this)">Java</div>
        <div class="pill" onclick="togglePill(this)">SQL</div>
        <div class="pill" onclick="togglePill(this)">AWS</div>
        <div class="pill" onclick="togglePill(this)">Docker</div>
        <div class="pill" onclick="togglePill(this)">Kubernetes</div>
        <div class="pill" onclick="togglePill(this)">Machine Learning</div>
        <div class="pill" onclick="togglePill(this)">Data Analysis</div>
        <div class="pill" onclick="togglePill(this)">Pandas</div>
        <div class="pill" onclick="togglePill(this)">TensorFlow</div>
        <div class="pill" onclick="togglePill(this)">Git</div>
        <div class="pill" onclick="togglePill(this)">UI/UX Design</div>
        <div class="pill" onclick="togglePill(this)">Figma</div>
        <div class="pill" onclick="togglePill(this)">Product Management</div>
        <div class="pill" onclick="togglePill(this)">Agile</div>
        <div class="pill" onclick="togglePill(this)">Communication</div>
    </div>

    <label style="margin-top: 40px;"><strong>What are you looking for?</strong><br><small>This helps us personalize your recommendations</small></label>
    <div class="pill-group" id="interests-group">
      <div class="pill" onclick="togglePill(this)">Internships</div>
      <div class="pill" onclick="togglePill(this)">Full-time Jobs</div>
      <div class="pill" onclick="togglePill(this)">Remote Roles</div>
      <div class="pill" onclick="togglePill(this)">Research Positions</div>
      <div class="pill" onclick="togglePill(this)">Freelance</div>
      <div class="pill" onclick="togglePill(this)">Part-time</div>
    </div>

    <div class="btn-group">
      <button class="btn back-btn" onclick="window.history.back()">‚Üê Back</button>
      <button class="btn complete-btn" onclick="completeSetup()">Complete Setup ‚Üí</button>
    </div>

    <div class="skip" onclick="window.location.href='dashboard.html'">Skip for now</div>
  </div>
     <!-- Logout Confirmation Modal -->
  <div id="logout-modal" class="modal" style="display: none;">
    <div class="modal-content" style="text-align: center; padding: 40px; width: 350px; background: white; border-radius: 16px;">
      <h3 style="margin-bottom: 30px;">Are you sure you want to log out?</h3>
      <div>
        <button onclick="confirmLogout()" style="padding: 12px 30px; background: #ef4444; color: white; border: none; border-radius: 30px; margin: 0 10px; cursor: pointer; font-weight: bold;">Yes</button>
        <button onclick="closeLogoutModal()" style="padding: 12px 30px; background: #e5e7eb; color: #333; border: none; border-radius: 30px; margin: 0 10px; cursor: pointer; font-weight: bold;">No</button>
      </div>
    </div>
  </div>

  <script src="js/api.js"></script>
  <script src="script.js"></script>

  <script>
    const selectedSkills = new Set();
    const selectedInterests = new Set();

    function togglePill(pill) {
      pill.classList.toggle("selected");
      const text = pill.textContent.trim();
      
      if (pill.classList.contains("selected")) {
        if (pill.parentElement.id === "skills-group") {
          selectedSkills.add(text);
        } else {
          selectedInterests.add(text);
        }
      } else {
        selectedSkills.delete(text);
        selectedInterests.delete(text);
      }
    }

    async function completeSetup() {
        if (selectedSkills.size === 0) {
    alert("Please select at least one skill");
    return;
    }

  // Load data from first page
        const tempStr = localStorage.getItem("temp_profile");
        if (!tempStr) {
            alert("Profile data missing ‚Äî go back to first page");
            return;
     }
        const temp = JSON.parse(tempStr);

        const payload = {
            user_id: Number(localStorage.getItem("user_id")),
            experience_level: temp.experience_level || "Beginner",
            preferred_category: temp.preferred_category || "Data",
            preferred_location: temp.preferred_location || "Anywhere",
            skills: Array.from(selectedSkills).join(", "),
            preferred_workplace: temp.preferred_workplace || "Remote",
            // Interests as employment type if needed
            preferred_employment_type: Array.from(selectedInterests).join(", ") || "Full-time"
        };

        try {
            const res = await apiFetch("/auth/complete-profile", {
                method: "POST",
                body: JSON.stringify(payload)
         });

            // Clean up
            localStorage.removeItem("temp_profile");

            alert("Setup complete! Loading recommendations...");
            window.location.href = "dashboard.html";
        }   catch (err) {
            alert("Error: " + (err.message || "Save failed"));
        }
}
  </script>
</body>
</html>